midRes_triton:
 tensor([15.7812], device='cuda:0')
midRes_ref:
 tensor([15.7734], device='cuda:0')
midRes_diff:
 tensor([0.0078])
midRes max abs diff: 0.0625

all diff: 
tensor([[[[-0.0312],
          [ 0.0000],
          [-0.0156],
          [ 0.0000],
          [ 0.0000],
          [ 0.0000],
          [-0.0039],
          [ 0.0000],
          [ 0.0156],
          [-0.0312],
          [ 0.0000],
          [-0.0156],
          [-0.0156],
          [ 0.0156],
          [-0.0156],
          [-0.0078],
          [-0.0156],
          [-0.0312],
          [-0.0156],
          [ 0.0000],
          [-0.0156],
          [ 0.0000],
          [ 0.0156],
          [ 0.0156],
          [ 0.0000],
          [ 0.0000],
          [-0.0312],
          [ 0.0156],
          [-0.0156],
          [ 0.0000],
          [ 0.0312],
          [ 0.0156],
          [ 0.0000],
          [ 0.0156],
          [ 0.0000],
          [ 0.0156],
          [-0.0156],
          [ 0.0000],
          [-0.0312],
          [ 0.0000],
          [-0.0312],
          [ 0.0000],
          [ 0.0156],
          [ 0.0000],
          [ 0.0000],
          [ 0.0156],
          [ 0.0312],
          [ 0.0000],
          [ 0.0000],
          [-0.0156],
          [ 0.0156],
          [-0.0156],
          [ 0.0000],
          [-0.0156],
          [ 0.0312],
          [ 0.0000],
          [-0.0156],
          [ 0.0156],
          [ 0.0156],
          [ 0.0156],
          [-0.0156],
          [ 0.0312],
          [ 0.0000],
          [ 0.0000],
          [-0.0156],
          [ 0.0312],
          [ 0.0000],
          [ 0.0312],
          [ 0.0156],
          [ 0.0156],
          [ 0.0156],
          [-0.0078],
          [ 0.0000],
          [ 0.0312],
          [ 0.0000],
          [ 0.0000],
          [-0.0156],
          [ 0.0312],
          [ 0.0078],
          [-0.0156],
          [-0.0078],
          [-0.0156],
          [ 0.0000],
          [ 0.0000],
          [-0.0312],
          [ 0.0312],
          [-0.0156],
          [ 0.0156],
          [ 0.0000],
          [ 0.0156],
          [-0.0312],
          [ 0.0156],
          [ 0.0312],
          [ 0.0000],
          [ 0.0000],
          [ 0.0000],
          [ 0.0000],
          [ 0.0000],
          [-0.0312],
          [-0.0312],
          [ 0.0312],
          [-0.0156],
          [ 0.0156],
          [ 0.0156],
          [ 0.0156],
          [ 0.0156],
          [ 0.0000],
          [ 0.0000],
          [ 0.0000],
          [-0.0156],
          [-0.0156],
          [ 0.0312],
          [-0.0312],
          [ 0.0000],
          [-0.0156],
          [-0.0156],
          [ 0.0000],
          [-0.0078],
          [ 0.0000],
          [-0.0156],
          [-0.0078],
          [ 0.0000],
          [-0.0156],
          [ 0.0156],
          [ 0.0000],
          [ 0.0312],
          [ 0.0000],
          [-0.0156],
          [ 0.0312],
          [-0.0156],
          [ 0.0000],
          [ 0.0312],
          [-0.0625],
          [ 0.0312],
          [-0.0156],
          [ 0.0156],
          [ 0.0000],
          [ 0.0000],
          [-0.0156],
          [-0.0156],
          [ 0.0000],
          [-0.0156],
          [-0.0156],
          [-0.0156],
          [ 0.0000],
          [ 0.0000],
          [ 0.0000],
          [ 0.0000],
          [ 0.0312],
          [ 0.0312],
          [ 0.0000],
          [ 0.0312],
          [ 0.0000],
          [ 0.0312],
          [ 0.0156],
          [ 0.0000],
          [-0.0312],
          [-0.0156],
          [-0.0156],
          [ 0.0000],
          [ 0.0156],
          [-0.0156],
          [-0.0078],
          [-0.0312],
          [ 0.0156],
          [ 0.0000],
          [ 0.0156],
          [ 0.0000],
          [ 0.0000],
          [ 0.0078],
          [ 0.0312],
          [ 0.0312],
          [-0.0156],
          [ 0.0156],
          [ 0.0000],
          [ 0.0000],
          [ 0.0000],
          [ 0.0156],
          [ 0.0000],
          [ 0.0000],
          [ 0.0000],
          [ 0.0000],
          [ 0.0156],
          [-0.0312],
          [ 0.0000],
          [ 0.0156],
          [ 0.0000],
          [ 0.0312],
          [ 0.0156],
          [-0.0156],
          [-0.0312],
          [-0.0156],
          [-0.0156],
          [-0.0156],
          [ 0.0078],
          [ 0.0156],
          [ 0.0312],
          [-0.0156],
          [ 0.0312],
          [ 0.0000],
          [ 0.0000],
          [-0.0078],
          [-0.0156],
          [ 0.0312],
          [-0.0312],
          [ 0.0000],
          [ 0.0312],
          [ 0.0000],
          [-0.0156],
          [ 0.0000],
          [ 0.0000],
          [-0.0156],
          [ 0.0000],
          [ 0.0000],
          [ 0.0000],
          [-0.0312],
          [ 0.0078],
          [-0.0156],
          [ 0.0000],
          [ 0.0000],
          [ 0.0000],
          [ 0.0312],
          [ 0.0312],
          [-0.0312],
          [ 0.0000],
          [-0.0156],
          [ 0.0000],
          [-0.0156],
          [-0.0156],
          [ 0.0625],
          [ 0.0000],
          [-0.0156],
          [ 0.0000],
          [ 0.0000],
          [-0.0312],
          [-0.0312],
          [ 0.0312],
          [-0.0312],
          [ 0.0000],
          [ 0.0000],
          [-0.0312],
          [ 0.0078],
          [ 0.0156],
          [ 0.0156],
          [ 0.0000],
          [ 0.0156],
          [ 0.0156],
          [ 0.0000],
          [ 0.0312],
          [ 0.0156],
          [ 0.0000],
          [-0.0156],
          [-0.0156],
          [ 0.0156],
          [-0.0039],
          [ 0.0000]],

         [[ 0.0000],
          [-0.0312],
          [-0.0078],
          [ 0.0000],
          [ 0.0156],
          [ 0.0000],
          [-0.0156],
          [ 0.0312],
          [-0.0312],
          [ 0.0000],
          [ 0.0000],
          [-0.0078],
          [ 0.0000],
          [ 0.0000],
          [ 0.0000],
          [ 0.0000],
          [ 0.0156],
          [ 0.0156],
          [ 0.0000],
          [ 0.0078],
          [ 0.0312],
          [ 0.0312],
          [-0.0156],
          [ 0.0000],
          [-0.0312],
          [ 0.0000],
          [ 0.0000],
          [ 0.0000],
          [ 0.0156],
          [ 0.0156],
          [ 0.0000],
          [ 0.0000],
          [ 0.0078],
          [ 0.0000],
          [ 0.0156],
          [ 0.0000],
          [ 0.0312],
          [ 0.0000],
          [-0.0156],
          [ 0.0000],
          [-0.0156],
          [ 0.0312],
          [ 0.0000],
          [ 0.0156],
          [-0.0312],
          [ 0.0000],
          [ 0.0156],
          [-0.0156],
          [-0.0156],
          [-0.0156],
          [-0.0312],
          [ 0.0156],
          [ 0.0312],
          [ 0.0000],
          [-0.0078],
          [ 0.0000],
          [ 0.0000],
          [ 0.0000],
          [-0.0156],
          [ 0.0000],
          [ 0.0000],
          [-0.0078],
          [ 0.0156],
          [-0.0312],
          [ 0.0000],
          [-0.0312],
          [ 0.0156],
          [ 0.0000],
          [-0.0312],
          [ 0.0000],
          [ 0.0000],
          [ 0.0000],
          [ 0.0312],
          [ 0.0000],
          [-0.0039],
          [ 0.0000],
          [ 0.0000],
          [ 0.0000],
          [ 0.0312],
          [-0.0156],
          [-0.0156],
          [ 0.0156],
          [-0.0156],
          [ 0.0156],
          [ 0.0156],
          [-0.0156],
          [ 0.0312],
          [ 0.0000],
          [ 0.0000],
          [ 0.0312],
          [-0.0156],
          [-0.0312],
          [ 0.0156],
          [ 0.0000],
          [-0.0156],
          [ 0.0000],
          [ 0.0156],
          [ 0.0000],
          [ 0.0156],
          [-0.0312],
          [ 0.0156],
          [ 0.0000],
          [ 0.0000],
          [-0.0156],
          [ 0.0000],
          [ 0.0000],
          [ 0.0000],
          [ 0.0000],
          [-0.0156],
          [ 0.0156],
          [-0.0156],
          [-0.0156],
          [ 0.0156],
          [ 0.0000],
          [-0.0312],
          [ 0.0312],
          [ 0.0000],
          [-0.0156],
          [ 0.0000],
          [-0.0156],
          [-0.0156],
          [ 0.0312],
          [-0.0078],
          [-0.0156],
          [ 0.0000],
          [-0.0156],
          [ 0.0156],
          [ 0.0000],
          [ 0.0000],
          [ 0.0156],
          [-0.0312],
          [-0.0156],
          [-0.0312],
          [ 0.0000],
          [ 0.0312],
          [ 0.0000],
          [-0.0312],
          [-0.0156],
          [-0.0078],
          [ 0.0000],
          [ 0.0000],
          [-0.0156],
          [ 0.0156],
          [ 0.0312],
          [ 0.0000],
          [-0.0156],
          [ 0.0000],
          [ 0.0000],
          [ 0.0000],
          [-0.0156],
          [ 0.0156],
          [ 0.0000],
          [-0.0156],
          [ 0.0078],
          [ 0.0000],
          [ 0.0156],
          [-0.0078],
          [-0.0312],
          [-0.0156],
          [ 0.0156],
          [ 0.0000],
          [ 0.0000],
          [-0.0078],
          [-0.0156],
          [ 0.0156],
          [ 0.0000],
          [ 0.0312],
          [-0.0078],
          [-0.0312],
          [-0.0078],
          [ 0.0156],
          [-0.0156],
          [ 0.0000],
          [-0.0156],
          [ 0.0156],
          [-0.0156],
          [ 0.0156],
          [ 0.0156],
          [-0.0156],
          [-0.0156],
          [-0.0156],
          [ 0.0156],
          [ 0.0312],
          [ 0.0078],
          [ 0.0000],
          [ 0.0156],
          [ 0.0000],
          [ 0.0000],
          [ 0.0000],
          [ 0.0000],
          [ 0.0312],
          [ 0.0000],
          [-0.0078],
          [-0.0078],
          [ 0.0156],
          [ 0.0000],
          [-0.0156],
          [ 0.0156],
          [ 0.0000],
          [ 0.0000],
          [ 0.0156],
          [-0.0312],
          [-0.0156],
          [ 0.0156],
          [-0.0156],
          [ 0.0000],
          [ 0.0078],
          [ 0.0000],
          [ 0.0000],
          [-0.0312],
          [ 0.0156],
          [-0.0156],
          [ 0.0000],
          [ 0.0000],
          [-0.0078],
          [ 0.0000],
          [ 0.0000],
          [ 0.0078],
          [ 0.0156],
          [ 0.0156],
          [ 0.0156],
          [ 0.0156],
          [ 0.0156],
          [-0.0312],
          [ 0.0156],
          [ 0.0156],
          [ 0.0078],
          [ 0.0156],
          [ 0.0156],
          [ 0.0000],
          [ 0.0000],
          [-0.0312],
          [-0.0156],
          [-0.0312],
          [ 0.0156],
          [ 0.0156],
          [-0.0156],
          [ 0.0000],
          [-0.0156],
          [ 0.0000],
          [ 0.0156],
          [-0.0156],
          [ 0.0000],
          [ 0.0000],
          [ 0.0000],
          [ 0.0000],
          [ 0.0000],
          [ 0.0000],
          [ 0.0156],
          [ 0.0156],
          [-0.0156],
          [-0.0312],
          [ 0.0156],
          [ 0.0000],
          [-0.0078],
          [ 0.0078]]]])
midRes allclose: False


O_triton:
 tensor([ 0.1694,  0.1146, -0.0191, -0.0919, -0.1444,  0.0850,  0.0404,  0.0862,
        -0.0620,  0.0193,  0.0995, -0.0663,  0.0858,  0.0478,  0.0681,  0.1466,
        -0.0715,  0.0096,  0.0117,  0.1477,  0.1592,  0.1306, -0.0447, -0.1992,
        -0.1116, -0.0923,  0.0210,  0.0259, -0.0839,  0.0044, -0.0362, -0.0202,
        -0.0861, -0.1858,  0.0037, -0.0142,  0.0914,  0.0112,  0.0760, -0.0879,
         0.0853, -0.0132,  0.0070, -0.0058, -0.0293, -0.0663,  0.0108, -0.0457,
         0.0095,  0.0516, -0.0968,  0.1691, -0.0348,  0.1947, -0.1263,  0.0304,
        -0.0247,  0.0580,  0.3049, -0.1738,  0.0946, -0.1428,  0.0465,  0.1930],
       device='cuda:0')
O_ref:
 tensor([ 0.1694,  0.1147, -0.0192, -0.0920, -0.1444,  0.0851,  0.0405,  0.0862,
        -0.0620,  0.0192,  0.0995, -0.0664,  0.0858,  0.0478,  0.0681,  0.1466,
        -0.0715,  0.0096,  0.0118,  0.1478,  0.1593,  0.1306, -0.0446, -0.1993,
        -0.1116, -0.0922,  0.0209,  0.0259, -0.0840,  0.0044, -0.0362, -0.0202,
        -0.0861, -0.1858,  0.0037, -0.0142,  0.0914,  0.0112,  0.0760, -0.0879,
         0.0853, -0.0132,  0.0069, -0.0057, -0.0293, -0.0663,  0.0108, -0.0458,
         0.0094,  0.0516, -0.0969,  0.1692, -0.0348,  0.1948, -0.1263,  0.0304,
        -0.0247,  0.0580,  0.3052, -0.1740,  0.0947, -0.1429,  0.0464,  0.1930],
       device='cuda:0')
O_diff:
 tensor([ 0.0000e+00, -1.8311e-04,  6.1035e-05,  6.1035e-05,  0.0000e+00,
        -1.2207e-04, -9.1553e-05,  0.0000e+00,  3.0518e-05,  3.0518e-05,
        -6.1035e-05,  6.1035e-05,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00, -6.1035e-05,  0.0000e+00, -4.5776e-05, -1.2207e-04,
        -1.2207e-04,  0.0000e+00, -3.0518e-05,  1.2207e-04,  6.1035e-05,
        -6.1035e-05,  1.0681e-04, -1.5259e-05,  6.1035e-05,  4.9591e-05,
        -3.0518e-05, -3.0518e-05,  0.0000e+00,  0.0000e+00,  2.0981e-05,
         0.0000e+00,  6.1035e-05, -7.6294e-06, -6.1035e-05,  0.0000e+00,
         0.0000e+00,  1.5259e-05,  7.6294e-05, -2.6703e-05,  1.5259e-05,
         6.1035e-05,  2.2888e-05,  6.1035e-05,  6.8665e-05,  0.0000e+00,
         6.1035e-05, -1.2207e-04,  3.0518e-05, -1.2207e-04,  0.0000e+00,
        -1.5259e-05,  0.0000e+00,  0.0000e+00, -2.4414e-04,  1.2207e-04,
        -1.2207e-04,  1.2207e-04,  1.2207e-04,  0.0000e+00])
O max abs diff: 1.912109375

all diff: 
tensor([[[[ 2.2583e-03,  7.3853e-03, -2.6855e-03,  ...,  9.0332e-03,
           -1.2207e-03,  2.6474e-03],
          [ 4.7073e-03,  4.9591e-03, -6.5613e-03,  ...,  1.8921e-02,
           -7.5073e-03, -1.4061e-02],
          [ 7.0953e-03,  1.1444e-02, -4.6753e-02,  ...,  4.6143e-02,
            2.0020e-02, -3.1921e-02],
          ...,
          [-5.6885e-02,  1.0071e-03, -2.1576e-02,  ...,  4.5013e-02,
           -1.9043e-02, -6.4697e-02],
          [-7.9163e-02,  8.9746e-01, -3.7793e-01,  ...,  6.7871e-01,
            1.9188e-03, -5.7275e-01],
          [-2.1530e-02,  2.3575e-02, -2.0767e-02,  ...,  3.0396e-02,
           -1.2085e-02, -2.6489e-02]],

         [[ 1.0681e-01, -2.3364e-01, -1.2708e-01,  ..., -4.5288e-02,
            2.2852e-01,  2.3987e-02],
          [ 8.7036e-02, -8.4717e-02, -2.1362e-02,  ..., -4.1504e-02,
            6.5308e-02, -9.7656e-04],
          [ 3.3862e-01, -7.3364e-02, -2.0337e-01,  ..., -3.1323e-01,
            3.6816e-01, -9.1370e-02],
          ...,
          [-1.5182e-03, -2.8591e-03, -2.9541e-02,  ..., -3.4241e-02,
            3.8208e-02, -1.2543e-02],
          [-5.6152e-03, -2.4048e-01, -4.6234e-02,  ..., -5.0977e-01,
            1.1829e-01, -1.6040e-01],
          [ 0.0000e+00, -1.8311e-04,  6.1035e-05,  ...,  1.2207e-04,
            1.2207e-04,  0.0000e+00]]]])
O allclose: False


